# WIN5Declaraer

## WIN5 人気順ランダム抽選ツール（仕様書 / README）

## 目的
WIN5を「戦略買い」ではなく、人気上位が選ばれやすい重み付きランダム抽選で購入するためのツールを作る。  
完全ランダムは的中率が低すぎるため、人気順1〜Nの範囲に限定し、上位人気が出やすい分布で抽選する。

## 提供形態
- GitHub Pagesで公開する
- HTML + CSS + JavaScript の単一ページ（静的サイト）
- 外部API / スクレイピングはしない
- データは localStorage に保存する

## 画面構成（UI）
- 画面上部：ヘッダー
  - ピクトグラム、アプリ名、サブコピー
- 抽選アクション
  - 抽選数（プルダウン、初期値 1）
  - 抽選ボタン（中央配置 / 「抽選する！」）
- 画面中央：5つのレース枠（四角窓）
  - レース枠は5つ固定
  - 各枠の下に「N番人気まで」プルダウン
    - 各レース独立に設定できる
    - 初期値は全レース N=10
- 画面下部：抽選ログ（履歴）
  - 抽選結果が蓄積される（抽選を実行しても過去ログは消さない）
  - ログ各行に購入済みチェックボックスを配置
  - ログ各行に「的中」丸型チェックを配置
  - ログ各行にタイムスタンプを表示（`YYYY-MM-DD HH:mm` 形式）
  - ログ行の右端にゴミ箱アイコンで1行削除
  - ログ表の外側に「全解除」ボタン
  - ログ説明文は全解除ボタンの右側に表示
- 画面最下部：重み設定
  - アコーディオン（初期は折りたたみ）
  - 計算式 `weight(i) = 1 / i^s` を表示
  - 偏りパラメータ（スライダー）で調整
  - 基本は触らない想定だが、変更可能にする
  - 初期化ボタンの右に寄付リンク（`https://github.com/sponsors/VarYUvrc`）
  - フッターに制作者表記と免責文を表示

## 抽選仕様
### 抽選単位
- 1通り（5レースそれぞれ1つの人気）を1枚として扱う
- 抽選ボタン1回で、指定した枚数（通り数）を生成する
- 購入数は固定しない
  - 通り数が1のままでも、抽選ボタンを複数回押してログから必要な分だけ買える運用を想定

### 入力データ（レース情報）
- レース情報（馬番・馬名・人気データなど）の入力は当面実装しない
- 出力は「人気番号」のみを扱う
  - 例：レース1は「人気3」、レース2は「人気1」…のような形
- 即PATでの購入はユーザーが人気順を参照して手作業で対応する前提

### 抽選範囲
- 各レースごとに抽選対象の人気上限 `N` を設定する
  - 例：N=10なら人気1〜10から抽選
- Nの初期値は全レース10

### 分布（上位が出やすい重み付き）
- 上位人気ほど選ばれやすい重みを付ける
- 分布は「べき乗」を採用し、偏りをスライダーで調整する
  - べき乗：`weight(i) = 1 / i^s`
- 抽選は「重複なし」ではなく、各レースにつき1つの人気番号を生成する

## 表示仕様
### 5つのレース枠表示
- 抽選ボタン押下で生成された通り数ぶんを、各レース枠にカード表示する
  - カード内は「数字 + 人気」表示
  - 表示は常に1列（縦並び）
  - 抽選結果はレース1→2→3→4→5の人気順でソートして並べる

### 抽選ログ
- 抽選ボタン押下で生成された各通り（1枚）が、ログに1行ずつ追加される
- ログは新しいものが上（newest first）
- ログ行には以下を表示する
  - 購入済みチェックボックス
  - タイムスタンプ（`YYYY-MM-DD HH:mm`）
  - 組み合わせ表示（例：`R1:3 / R2:1 / R3:8 / R4:2 / R5:5`）
  - 的中チェック（丸型）
  - 右端のゴミ箱アイコンで行を削除できる
- ログもソート後の順番で記録する
- ログ上限を設け、肥大化を防ぐ（例：最大800行など）

## 保存仕様（localStorage）
- 保存対象
  - 各レースのN設定（5つ）
  - 抽選1回あたりの通り数
  - 分布の偏りパラメータ
  - 直近の抽選結果（5枠の表示復元用）
  - 抽選ログ（購入済み/的中チェック含む）
- ブラウザ更新・再起動しても復元されること

## 初期化仕様
- 「初期化」操作で以下をすべてリセットする
  - 設定（N、通り数、分布設定）
  - 抽選ログ
  - 直近の表示

## 非機能要件
- 単一HTMLファイルで動作すること（ビルド不要）
- スマホではPC幅を固定し、縮小表示でレイアウトを崩さない
- レイアウトの最大幅は約940pxでタイトに表示する
- 外部通信なし（完全ローカルで完結）

## ローカル起動（開発用）=

```bash
$ npx serve .
```
