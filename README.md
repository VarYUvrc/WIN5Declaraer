# WIN5Declaraer

## WIN5 人気順ランダム抽選ツール（仕様書 / README）

## 目的
WIN5を「戦略買い」ではなく、人気上位が選ばれやすい重み付きランダム抽選で購入するためのツールを作る。  
完全ランダムは的中率が低すぎるため、人気順1〜Nの範囲に限定し、上位人気が強く出やすい分布で抽選する。

## 提供形態
- GitHub Pagesで公開する
- HTML + CSS + JavaScript の単一ページ（静的サイト）
- 外部API / スクレイピングはしない
- データは localStorage に保存する

## 画面構成（UI）
- 画面上部：コントロール領域
  - 「抽選1回あたりの抽選数（通り数）」入力（初期値 1）
  - 抽選ボタン（中央寄せ想定）
- 画面中央：5つのレース枠（四角窓）
  - レース枠は5つ固定
  - 各枠の下に「抽選上限N（人気）」プルダウン
    - 各レース独立に設定できる
    - 初期値は全レース N=10
- 画面下部：抽選ログ（履歴）
  - 抽選結果が蓄積される（抽選を実行しても過去ログは消さない）
  - ログ各行に購入済みチェックボックスを配置
  - ログ各行の左にタイムスタンプを表示（`YYYY-MM-DD HH:mm` 形式）
  - ログには「チェック全解除」「チェック行削除」等の操作を持つ
- 画面最下部：重み設定
  - 分布タイプ選択（例：指数減衰 / べき乗）
  - 偏りパラメータ（スライダー）
  - 基本は触らない想定だが、変更可能にする

## 抽選仕様
### 投票方式
- 「方式B」を採用する
  - 1通り（5レースそれぞれ1つの人気）を1枚として扱う
  - 抽選ボタン1回で、指定した枚数（通り数）を生成する
- 購入数を5に固定しない
  - 通り数が1のままでも、抽選ボタンを複数回押してログから必要な分だけ買える運用を想定

### 入力データ（レース情報）
- レース情報（馬番・馬名・人気データなど）の入力は当面実装しない
- 出力は「人気番号」のみを扱う
  - 例：レース1は「人気3」、レース2は「人気1」…のような形
- 即PATでの購入はユーザーが人気順を参照して手作業で対応する前提

### 抽選範囲
- 各レースごとに抽選対象の人気上限 `N` を設定する
  - 例：N=10なら人気1〜10から抽選
- Nの初期値は全レース10

### 分布（上位が出やすい重み付き）
- 上位人気ほど選ばれやすい重みを付ける
- 分布はUIで切替・調整できるようにする（基本触らない想定）
  - 指数減衰：`weight(i) = exp(-λ * (i-1))`
  - べき乗：`weight(i) = 1 / i^s`
- 抽選は「重複なし」ではなく、各レースにつき1つの人気番号を生成する

## 表示仕様
### 5つのレース枠表示
- 抽選ボタン押下で生成された通り数ぶんを、各レース枠に縦に表示する
  - 例（通り数=3の場合、レース1枠）:
    - `1: 人気2`
    - `2: 人気1`
    - `3: 人気6`

### 抽選ログ
- 抽選ボタン押下で生成された各通り（1枚）が、ログに1行ずつ追加される
- ログは新しいものが上（newest first）
- ログ行には以下を表示する
  - 購入済みチェックボックス
  - タイムスタンプ（`YYYY-MM-DD HH:mm`）
  - 組み合わせ表示（例：`R1:人気3 / R2:人気1 / R3:人気8 / R4:人気2 / R5:人気5`）
- ログ上限を設け、肥大化を防ぐ（例：最大800行など）

## 保存仕様（localStorage）
- 保存対象
  - 各レースのN設定（5つ）
  - 抽選1回あたりの通り数
  - 分布タイプ、偏りパラメータ
  - 直近の抽選結果（5枠の表示復元用）
  - 抽選ログ（購入済みチェック含む）
- ブラウザ更新・再起動しても復元されること

## 初期化仕様
- 「初期化」操作で以下をすべてリセットする
  - 設定（N、通り数、分布設定）
  - 抽選ログ
  - 直近の表示

## 非機能要件
- 単一HTMLファイルで動作すること（ビルド不要）
- スマホ利用を前提に、視認性とタップしやすさを優先する
- 外部通信なし（完全ローカルで完結）

## ローカル起動（開発用）=

```bash
$ npx serve .
```
